<template>
  <div class="structure-page">
    <div class="page-header">
      <h1 class="page-title">ã‚·ã‚¹ãƒ†ãƒ æ§‹é€ </h1>
      <p class="page-description">ãƒ•ãƒ­ãƒ¼ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨å‡¦ç†è©³ç´°ã¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’è¡¨ç¤º</p>
    </div>

    <!-- ãƒ•ãƒ­ãƒ¼1: ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ -->
    <div class="flow-section">
      <div class="flow-section-header">
        <span class="flow-section-number">1</span>
        <span class="flow-section-title">ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</span>
      </div>
      <div class="flow-container">
        <div class="flow-line">
          <!-- ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ -->
          <div class="flow-node flow-node-start" @click="openPopup('upload')">
            <div class="node-header">
              <span class="node-icon">ğŸ“</span>
              <span class="node-label">ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</span>
            </div>
            <div class="node-desc">ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ­ãƒƒãƒ—</div>
          </div>

          <div class="flow-arrow">â†’</div>

          <!-- ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼åˆ†å² -->
          <div class="flow-branch-vertical">
            <div class="branch-header">å½¢å¼åˆ¤å®š</div>
            <div class="branch-items-vertical">
              <div class="flow-node-mini" @click="openPopup('pdf')">
                <span class="node-icon-mini">ğŸ“‘</span>
                <span class="node-label-mini">PDF</span>
                <span class="node-api api-openai">GPT-4o</span>
              </div>
              <div class="flow-node-mini" @click="openPopup('excel')">
                <span class="node-icon-mini">ğŸ“Š</span>
                <span class="node-label-mini">Excel</span>
                <span class="node-api api-lib">xlsx</span>
              </div>
              <div class="flow-node-mini" @click="openPopup('pptx')">
                <span class="node-icon-mini">ğŸ“</span>
                <span class="node-label-mini">PPTX/Word</span>
                <span class="node-api api-lib">JSZip</span>
              </div>
              <div class="flow-node-mini" @click="openPopup('audio')">
                <span class="node-icon-mini">ğŸµ</span>
                <span class="node-label-mini">éŸ³å£°</span>
                <span class="node-api api-openai">Whisper</span>
              </div>
              <div class="flow-node-mini" @click="openPopup('video')">
                <span class="node-icon-mini">ğŸ¬</span>
                <span class="node-label-mini">å‹•ç”»</span>
                <span class="node-api api-openai">Whisper</span>
              </div>
            </div>
          </div>

          <div class="flow-arrow">â†’</div>

          <!-- ç¯„å›²é¸æŠ -->
          <div class="flow-node flow-node-question" @click="openPopup('range')">
            <div class="node-header">
              <span class="node-icon">ğŸ“</span>
              <span class="node-label">ç¯„å›²é¸æŠ</span>
            </div>
            <div class="node-desc">ãƒšãƒ¼ã‚¸/ã‚·ãƒ¼ãƒˆæŒ‡å®š</div>
          </div>

          <div class="flow-arrow">â†’</div>

          <!-- ç¨®åˆ¥é¸æŠ -->
          <div class="flow-node flow-node-question" @click="openPopup('type')">
            <div class="node-header">
              <span class="node-icon">ğŸ·ï¸</span>
              <span class="node-label">ç¨®åˆ¥é¸æŠ</span>
            </div>
            <div class="node-desc">è¦‹æœ¬/æ•™æ/è‡ªç¤¾/é¡§å®¢</div>
          </div>

          <div class="flow-arrow">â†’</div>

          <!-- ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å®Œäº† -->
          <div class="flow-node flow-node-end">
            <div class="node-header">
              <span class="node-icon">âœ…</span>
              <span class="node-label">ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å®Œäº†</span>
            </div>
            <div class="node-desc">åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«è¿½åŠ å¯èƒ½</div>
          </div>
        </div>
      </div>
    </div>

    <!-- ãƒ•ãƒ­ãƒ¼2: ãƒ­ãƒ¼ãƒ—ãƒ¬æ§‹ç¯‰ -->
    <div class="flow-section">
      <div class="flow-section-header">
        <span class="flow-section-number">2</span>
        <span class="flow-section-title">ãƒ­ãƒ¼ãƒ—ãƒ¬æ§‹ç¯‰</span>
      </div>
      <div class="flow-container">
        <div class="flow-line">
          <!-- æ§‹ç¯‰ã‚¹ã‚¿ãƒ¼ãƒˆ -->
          <div class="flow-node flow-node-start" @click="openPopup('build-start')">
            <div class="node-header">
              <span class="node-icon">ğŸš€</span>
              <span class="node-label">æ§‹ç¯‰ã‚¹ã‚¿ãƒ¼ãƒˆ</span>
            </div>
            <div class="node-desc">ãƒœã‚¿ãƒ³æŠ¼ä¸‹</div>
          </div>

          <div class="flow-arrow">â†’</div>

          <!-- ä½¿ç”¨ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠ -->
          <div class="flow-node flow-node-question" @click="openPopup('file-select')">
            <div class="node-header">
              <span class="node-icon">ğŸ“„</span>
              <span class="node-label">ä½¿ç”¨ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠ</span>
            </div>
            <div class="node-desc">è¤‡æ•°é¸æŠå¯</div>
          </div>

          <div class="flow-arrow">â†’</div>

          <!-- ã‚´ãƒ¼ãƒ«é¸æŠ -->
          <div class="flow-node flow-node-question" @click="openPopup('goal')">
            <div class="node-header">
              <span class="node-icon">ğŸ¯</span>
              <span class="node-label">ã‚´ãƒ¼ãƒ«é¸æŠ</span>
            </div>
            <div class="node-desc">æš—è¨˜/èª¬æ˜/ãƒ’ã‚¢ãƒªãƒ³ã‚°ç­‰</div>
          </div>

          <div class="flow-arrow">â†’</div>

          <!-- ãƒ­ãƒ¼ãƒ—ãƒ¬æ§‹ç¯‰ -->
          <div class="flow-node flow-node-ai" @click="openPopup('build')">
            <div class="node-header">
              <span class="node-icon">ğŸ¤–</span>
              <span class="node-label">ãƒ­ãƒ¼ãƒ—ãƒ¬æ§‹ç¯‰</span>
              <span class="node-api api-responses">Responses API</span>
            </div>
            <div class="node-desc">ãƒã‚¤ãƒ³ãƒˆæŠ½å‡ºãƒ»å°æœ¬ç”Ÿæˆ</div>
          </div>

          <div class="flow-arrow">â†’</div>

          <!-- æ§‹ç¯‰å®Œäº† -->
          <div class="flow-node flow-node-end">
            <div class="node-header">
              <span class="node-icon">âœ…</span>
              <span class="node-label">æ§‹ç¯‰å®Œäº†</span>
            </div>
            <div class="node-desc">è¨­è¨ˆãƒ‘ãƒãƒ«ã«è¡¨ç¤º</div>
          </div>
        </div>
      </div>
    </div>

    <!-- ãƒ•ãƒ­ãƒ¼3: ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆåˆæˆï¼ˆ4æ§‹æˆè¦ç´ ï¼‰ -->
    <div class="flow-section">
      <div class="flow-section-header">
        <span class="flow-section-number">3</span>
        <span class="flow-section-title">ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆåˆæˆï¼ˆ4æ§‹æˆè¦ç´ ï¼‰</span>
        <span class="flow-section-badge">AIä¸ä½¿ç”¨ãƒ»å³æ™‚åˆæˆ</span>
      </div>
      <div class="flow-container">
        <div class="flow-line">
          <!-- ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆãƒœã‚¿ãƒ³ -->
          <div class="flow-node flow-node-start" @click="openPopup('prompt-gen-start')">
            <div class="node-header">
              <span class="node-icon">âœ¨</span>
              <span class="node-label">ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆ</span>
            </div>
            <div class="node-desc">ãƒœã‚¿ãƒ³æŠ¼ä¸‹</div>
          </div>

          <div class="flow-arrow">â†’</div>

          <!-- æµã‚Œè¨­å®šãƒ€ã‚¤ã‚¢ãƒ­ã‚° -->
          <div class="flow-node flow-node-question" @click="openPopup('flow-settings')">
            <div class="node-header">
              <span class="node-icon">âš™ï¸</span>
              <span class="node-label">æµã‚Œè¨­å®š</span>
            </div>
            <div class="node-desc">è©±ã—æ–¹ãƒ»çµ‚äº†æ¡ä»¶ç­‰</div>
          </div>

          <div class="flow-arrow">â†’</div>

          <!-- 4æ§‹æˆè¦ç´ ã®åˆæˆ -->
          <div class="flow-branch-vertical">
            <div class="branch-header">4æ§‹æˆè¦ç´ ã®åˆæˆ</div>
            <div class="branch-items-vertical">
              <div class="flow-node-mini" @click="openPopup('comp-mode-instruction')">
                <span class="node-icon-mini">â‘ </span>
                <span class="node-label-mini">ãƒ¢ãƒ¼ãƒ‰æ¯ã®å›ºå®šæŒ‡ç¤º</span>
                <span class="node-api api-lib">å›ºå®š</span>
              </div>
              <div class="flow-node-mini" @click="openPopup('comp-character')">
                <span class="node-icon-mini">â‘¡</span>
                <span class="node-label-mini">äººæ ¼è¨­å®š</span>
                <span class="node-api api-lib">ã‚­ãƒ£ãƒ©</span>
              </div>
              <div class="flow-node-mini" @click="openPopup('comp-flow')">
                <span class="node-icon-mini">â‘¢</span>
                <span class="node-label-mini">æµã‚Œè¨­å®š</span>
                <span class="node-api api-lib">è¨­å®šå€¤</span>
              </div>
              <div class="flow-node-mini" @click="openPopup('comp-content')">
                <span class="node-icon-mini">â‘£</span>
                <span class="node-label-mini">å†…å®¹è¨­å®š</span>
                <span class="node-api api-lib">ãƒã‚¤ãƒ³ãƒˆç­‰</span>
              </div>
            </div>
          </div>

          <div class="flow-arrow">â†’</div>

          <!-- 4ãƒ¢ãƒ¼ãƒ‰åˆ†ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ -->
          <div class="flow-branch-vertical">
            <div class="branch-header">4ãƒ¢ãƒ¼ãƒ‰åˆ†ã‚’ç”Ÿæˆ</div>
            <div class="branch-items-vertical">
              <div class="flow-node-mini" @click="openPopup('mode-confirmation')">
                <span class="node-icon-mini">âœ…</span>
                <span class="node-label-mini">ç¢ºèªãƒ¢ãƒ¼ãƒ‰</span>
              </div>
              <div class="flow-node-mini" @click="openPopup('mode-practice')">
                <span class="node-icon-mini">ğŸ‘”</span>
                <span class="node-label-mini">å®Ÿè·µãƒ¢ãƒ¼ãƒ‰</span>
              </div>
              <div class="flow-node-mini" @click="openPopup('mode-subtitle')">
                <span class="node-icon-mini">ğŸ“–</span>
                <span class="node-label-mini">å°æœ¬ãƒ¢ãƒ¼ãƒ‰</span>
              </div>
              <div class="flow-node-mini" @click="openPopup('mode-demo')">
                <span class="node-icon-mini">âœ¨</span>
                <span class="node-label-mini">ãŠæ‰‹æœ¬ãƒ¢ãƒ¼ãƒ‰</span>
              </div>
            </div>
          </div>

          <div class="flow-arrow">â†’</div>

          <!-- ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè¡¨ç¤º -->
          <div class="flow-node flow-node-end" @click="openPopup('prompt-display')">
            <div class="node-header">
              <span class="node-icon">ğŸ‘ï¸</span>
              <span class="node-label">å‡ºåŠ›ãƒ‘ãƒãƒ«</span>
            </div>
            <div class="node-desc">åˆæˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè¡¨ç¤º</div>
          </div>
        </div>
      </div>
    </div>

    <!-- ãƒ•ãƒ­ãƒ¼4: ãƒ­ãƒ¼ãƒ—ãƒ¬å®Ÿè¡Œ -->
    <div class="flow-section">
      <div class="flow-section-header">
        <span class="flow-section-number">4</span>
        <span class="flow-section-title">ãƒ­ãƒ¼ãƒ—ãƒ¬å®Ÿè¡Œ</span>
      </div>
      <div class="flow-container">
        <div class="flow-line">
          <!-- ã‚¹ã‚¿ãƒ¼ãƒˆãƒœã‚¿ãƒ³ -->
          <div class="flow-node flow-node-start" @click="openPopup('play-start')">
            <div class="node-header">
              <span class="node-icon">â–¶ï¸</span>
              <span class="node-label">ã‚¹ã‚¿ãƒ¼ãƒˆ</span>
            </div>
            <div class="node-desc">ãƒœã‚¿ãƒ³æŠ¼ä¸‹</div>
          </div>

          <div class="flow-arrow">â†’</div>

          <!-- åˆæˆæ¸ˆã¿ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä½¿ç”¨ -->
          <div class="flow-node flow-node-data" @click="openPopup('use-merged')">
            <div class="node-header">
              <span class="node-icon">ğŸ“‹</span>
              <span class="node-label">åˆæˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ</span>
            </div>
            <div class="node-desc">äº‹å‰ã«åˆæˆæ¸ˆã¿</div>
          </div>

          <div class="flow-arrow">â†’</div>

          <!-- éŸ³å£°ä¼šè©± -->
          <div class="flow-node flow-node-realtime" @click="openPopup('realtime')">
            <div class="node-header">
              <span class="node-icon">ğŸ¤</span>
              <span class="node-label">éŸ³å£°ä¼šè©±</span>
              <span class="node-api api-realtime">Realtime API</span>
            </div>
            <div class="node-desc">ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ éŸ³å£°èªè­˜ãƒ»åˆæˆ</div>
          </div>

          <div class="flow-arrow">â†’</div>

          <!-- ä¼šè©±ãƒ­ã‚° -->
          <div class="flow-node flow-node-data">
            <div class="node-header">
              <span class="node-icon">ğŸ’¬</span>
              <span class="node-label">ä¼šè©±ãƒ­ã‚°</span>
            </div>
            <div class="node-desc">å…¨ç™ºè©±ã‚’è¨˜éŒ²</div>
          </div>

          <div class="flow-arrow">â†’</div>

          <!-- ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ç”Ÿæˆ -->
          <div class="flow-node flow-node-ai" @click="openPopup('feedback')">
            <div class="node-header">
              <span class="node-icon">ğŸ“Š</span>
              <span class="node-label">è©•ä¾¡ç”Ÿæˆ</span>
              <span class="node-api api-responses">gpt-4.1</span>
            </div>
            <div class="node-desc">100ç‚¹æº€ç‚¹ã§æ¡ç‚¹</div>
          </div>

          <div class="flow-arrow">â†’</div>

          <!-- çµæœè¡¨ç¤º -->
          <div class="flow-node flow-node-end" @click="openPopup('result')">
            <div class="node-header">
              <span class="node-icon">ğŸ†</span>
              <span class="node-label">çµæœè¡¨ç¤º</span>
            </div>
            <div class="node-desc">ã‚¹ã‚³ã‚¢ãƒ»æ”¹å–„ç‚¹</div>
          </div>
        </div>
      </div>
    </div>

    <!-- APIå‡¡ä¾‹ -->
    <div class="api-legend">
      <span class="legend-title">ä½¿ç”¨API:</span>
      <span class="legend-item"><span class="node-api api-openai">GPT-4o</span> OpenAI Vision/Whisper (gpt-4o)</span>
      <span class="legend-item"><span class="node-api api-lib">lib</span> ãƒ©ã‚¤ãƒ–ãƒ©ãƒª/å›ºå®šå‡¦ç†ï¼ˆAIä¸ä½¿ç”¨ï¼‰</span>
      <span class="legend-item"><span class="node-api api-responses">gpt-4.1</span> Responses API (gpt-4.1)</span>
      <span class="legend-item"><span class="node-api api-realtime">Realtime</span> Realtime API (gpt-4o-realtime-preview)</span>
    </div>

    <!-- ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ— -->
    <UModal v-model:open="showPopup" :title="popupTitle">
      <template #body>
        <div class="popup-content">
          <div class="popup-section">
            <h4 class="popup-section-title">å‡¦ç†æ¦‚è¦</h4>
            <p class="popup-description">{{ popupDescription }}</p>
          </div>

          <div v-if="popupApi" class="popup-section">
            <h4 class="popup-section-title">ä½¿ç”¨API</h4>
            <UBadge :color="getApiColor(popupApi)" variant="subtle">{{ popupApi }}</UBadge>
          </div>

          <div v-if="popupPrompt" class="popup-section">
            <h4 class="popup-section-title">
              ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ / ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
              <UButton
                variant="ghost"
                size="xs"
                icon="i-lucide-copy"
                class="popup-copy-btn"
                @click="copyPrompt"
              />
            </h4>
            <textarea
              v-model="popupPrompt"
              class="popup-prompt-textarea"
              :rows="15"
              readonly
            />
          </div>

          <div v-if="popupFilePath" class="popup-section">
            <span class="popup-file-path">{{ popupFilePath }}</span>
          </div>
        </div>
      </template>
      <template #footer>
        <div class="popup-footer">
          <UButton variant="ghost" color="neutral" @click="showPopup = false">é–‰ã˜ã‚‹</UButton>
        </div>
      </template>
    </UModal>
  </div>
</template>

<script setup lang="ts">
definePageMeta({
  layout: 'default'
})

const showPopup = ref(false)
const popupTitle = ref('')
const popupDescription = ref('')
const popupApi = ref('')
const popupPrompt = ref('')
const popupFilePath = ref('')
const currentNodeId = ref('')

interface NodeInfo {
  title: string
  description: string
  api?: string
  filePath?: string
  prompt?: string
}

const nodeInfoMap: Record<string, NodeInfo> = {
  'upload': {
    title: 'ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰',
    description: 'ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã¾ãŸã¯é¸æŠã—ã¦ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚\n\nå¯¾å¿œå½¢å¼:\n- PDF\n- Excel (.xlsx, .xls)\n- PowerPoint (.pptx)\n- Word (.docx)\n- éŸ³å£° (MP3, WAV, M4A)\n- å‹•ç”» (MP4, MOV, WebM)\n- ãƒ†ã‚­ã‚¹ãƒˆ (.txt)',
  },
  'pdf': {
    title: 'PDFå‡¦ç†',
    description: 'PDFã‚’ç”»åƒã¨ã—ã¦èª­ã¿å–ã‚Šã€GPT-4oã®ãƒ“ã‚¸ãƒ§ãƒ³æ©Ÿèƒ½ã§ãƒ†ã‚­ã‚¹ãƒˆã‚’æŠ½å‡ºã—ã¾ã™ã€‚å›³è¡¨ã‚„ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚‚ç†è§£ã—ã¦æ§‹é€ åŒ–ã•ã‚ŒãŸãƒ†ã‚­ã‚¹ãƒˆã«å¤‰æ›ã—ã¾ã™ã€‚',
    api: 'OpenAI API (GPT-4o Vision)',
    filePath: 'server/api/analyze.post.ts',
  },
  'excel': {
    title: 'Excelå‡¦ç†',
    description: 'xlsx.jsãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã—ã¦Excelãƒ•ã‚¡ã‚¤ãƒ«ã‚’è§£æã—ã€å„ã‚·ãƒ¼ãƒˆã®ãƒ‡ãƒ¼ã‚¿ã‚’CSVå½¢å¼ã«å¤‰æ›ã—ã¾ã™ã€‚\n\nAIã¯ä½¿ç”¨ã›ãšã€ãƒ­ãƒ¼ã‚«ãƒ«ã§å‡¦ç†ã—ã¾ã™ã€‚',
    api: 'ãƒ©ã‚¤ãƒ–ãƒ©ãƒª (xlsx.js)',
    filePath: 'server/utils/fileParser.ts'
  },
  'pptx': {
    title: 'PowerPoint / Wordå‡¦ç†',
    description: 'JSZipãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§OOXMLå½¢å¼ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è§£å‡ã—ã€XMLã‹ã‚‰ãƒ†ã‚­ã‚¹ãƒˆã‚’æŠ½å‡ºã—ã¾ã™ã€‚\n\nã‚¹ãƒ©ã‚¤ãƒ‰ã”ã¨ãƒ»æ®µè½ã”ã¨ã«æ§‹é€ åŒ–ã•ã‚ŒãŸãƒ†ã‚­ã‚¹ãƒˆã‚’å–å¾—ã—ã¾ã™ã€‚AIã¯ä½¿ç”¨ã—ã¾ã›ã‚“ã€‚',
    api: 'ãƒ©ã‚¤ãƒ–ãƒ©ãƒª (JSZip)',
    filePath: 'server/utils/fileParser.ts'
  },
  'audio': {
    title: 'éŸ³å£°å‡¦ç†',
    description: 'OpenAI Whisper APIã‚’ä½¿ç”¨ã—ã¦éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ–‡å­—èµ·ã“ã—ã—ã¾ã™ã€‚\n\næ—¥æœ¬èªã«æœ€é©åŒ–ã•ã‚Œã¦ãŠã‚Šã€é«˜ç²¾åº¦ãªãƒ†ã‚­ã‚¹ãƒˆå¤‰æ›ãŒå¯èƒ½ã§ã™ã€‚',
    api: 'OpenAI API (Whisper)',
    filePath: 'server/api/upload.post.ts'
  },
  'video': {
    title: 'å‹•ç”»å‡¦ç†',
    description: 'å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰éŸ³å£°ãƒˆãƒ©ãƒƒã‚¯ã‚’æŠ½å‡ºã—ã€OpenAI Whisper APIã§æ–‡å­—èµ·ã“ã—ã‚’è¡Œã„ã¾ã™ã€‚\n\né•·æ™‚é–“ã®å‹•ç”»ã‚‚å¯¾å¿œå¯èƒ½ã§ã™ã€‚',
    api: 'OpenAI API (Whisper)',
    filePath: 'server/api/upload.post.ts'
  },
  'range': {
    title: 'ç¯„å›²é¸æŠ',
    description: 'ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­ã‹ã‚‰ä½¿ç”¨ã™ã‚‹ç¯„å›²ã‚’é¸æŠã—ã¾ã™ã€‚ä¸è¦ãªéƒ¨åˆ†ã‚’é™¤å¤–ã™ã‚‹ã“ã¨ã§ã€ã‚ˆã‚Šç²¾åº¦ã®é«˜ã„ãƒ­ãƒ¼ãƒ—ãƒ¬æ§‹ç¯‰ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚\n\né¸æŠæ–¹æ³•:\n- PDF/PPTX: ãƒšãƒ¼ã‚¸/ã‚¹ãƒ©ã‚¤ãƒ‰ç•ªå·\n- Excel: ã‚·ãƒ¼ãƒˆå\n- å…¨éƒ¨: ã™ã¹ã¦ä½¿ç”¨',
  },
  'type': {
    title: 'ãƒ‡ãƒ¼ã‚¿ç¨®åˆ¥é¸æŠ',
    description: 'ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã®ç¨®é¡ã‚’é¸æŠã—ã¾ã™ã€‚ç¨®åˆ¥ã«å¿œã˜ã¦æœ€é©ãªå‡¦ç†æ–¹æ³•ãŒé©ç”¨ã•ã‚Œã¾ã™ã€‚\n\nç¨®åˆ¥:\n- è¦‹æœ¬ãƒ‡ãƒ¼ã‚¿: ãŠæ‰‹æœ¬ã®ä¼šè©±ã‚„å°æœ¬\n- æ•™æãƒ‡ãƒ¼ã‚¿: å­¦ç¿’å†…å®¹ã‚„è³‡æ–™\n- è‡ªç¤¾ãƒ‡ãƒ¼ã‚¿: å•†å“ãƒ»ã‚µãƒ¼ãƒ“ã‚¹æƒ…å ±\n- é¡§å®¢ãƒ‡ãƒ¼ã‚¿: é¡§å®¢ãƒ»å–å¼•å…ˆæƒ…å ±',
  },
  'build-start': {
    title: 'æ§‹ç¯‰ã‚¹ã‚¿ãƒ¼ãƒˆ',
    description: 'ã€Œæ§‹ç¯‰ã‚¹ã‚¿ãƒ¼ãƒˆã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãƒ­ãƒ¼ãƒ—ãƒ¬æ§‹ç¯‰ãƒ•ãƒ­ãƒ¼ã‚’é–‹å§‹ã—ã¾ã™ã€‚\n\nãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ¸ˆã¿ã®å ´åˆã€ä½¿ç”¨ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã™ã‚‹ã‚¹ãƒ†ãƒƒãƒ—ã«é€²ã¿ã¾ã™ã€‚\nãƒ•ã‚¡ã‚¤ãƒ«ãŒãªã„å ´åˆã¯ç›´æ¥ã‚´ãƒ¼ãƒ«é¸æŠã«é€²ã¿ã¾ã™ã€‚',
    filePath: 'app/components/ChatArea.vue (startRoleplayGeneration)',
  },
  'file-select': {
    title: 'ä½¿ç”¨ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠ',
    description: 'ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ¸ˆã¿ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã€ä»Šå›ã®æ§‹ç¯‰ã«ä½¿ç”¨ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¾ã™ã€‚\n\nè¤‡æ•°é¸æŠãŒå¯èƒ½ã§ã€é¸æŠã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ãŒãƒ­ãƒ¼ãƒ—ãƒ¬æ§‹ç¯‰ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚',
    filePath: 'app/components/ChatArea.vue (askForFileSelection)',
  },
  'goal': {
    title: 'ã‚´ãƒ¼ãƒ«é¸æŠ',
    description: 'ãƒ­ãƒ¼ãƒ—ãƒ¬ã§é”æˆã—ãŸã„ç›®æ¨™ã‚’é¸æŠã—ã¾ã™ã€‚é¸æŠã—ãŸã‚´ãƒ¼ãƒ«ã«å¿œã˜ã¦å°æœ¬ã‚„ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒæœ€é©åŒ–ã•ã‚Œã¾ã™ã€‚\n\nã‚´ãƒ¼ãƒ«:\n- æš—è¨˜: åŸºæœ¬ãƒ•ãƒ¬ãƒ¼ã‚ºã‚’è¦šãˆã‚‹\n- åˆ‡ã‚Šè¿”ã—: åè«–ã¸ã®å¯¾å¿œåŠ›\n- ãƒ’ã‚¢ãƒªãƒ³ã‚°: æƒ…å ±å¼•ãå‡ºã—åŠ›\n- è©±ã—æ–¹: ãƒˆãƒ¼ãƒ³ã‚„è¡¨ç¾åŠ›',
  },
  'build': {
    title: 'ãƒ­ãƒ¼ãƒ—ãƒ¬æ§‹ç¯‰',
    description: 'OpenAI Responses APIã‚’ä½¿ç”¨ã—ã¦ã€ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã¨ã‚´ãƒ¼ãƒ«ã«åŸºã¥ã„ã¦ãƒ­ãƒ¼ãƒ—ãƒ¬ã‚’æ§‹ç¯‰ã—ã¾ã™ã€‚\n\nå‡¦ç†å†…å®¹:\n1. ãƒ•ã‚¡ã‚¤ãƒ«å†…å®¹ã‹ã‚‰é‡è¦ãƒã‚¤ãƒ³ãƒˆã‚’æŠ½å‡º\n2. ã‚´ãƒ¼ãƒ«ã«å¿œã˜ãŸå­¦ç¿’ãƒã‚¤ãƒ³ãƒˆã‚’æ•´ç†\n3. æ¦‚è¦ãƒ»ãƒã‚¤ãƒ³ãƒˆãƒ»å°æœ¬ã‚’ç”Ÿæˆ',
    api: 'OpenAI Responses API (gpt-4.1)',
    filePath: 'server/api/agent/chat.post.ts',
  },
  'prompt-gen-start': {
    title: 'ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆé–‹å§‹',
    description: 'è¨­è¨ˆãƒ‘ãƒãƒ«ã®ã€Œãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã€4æ§‹æˆè¦ç´ ã®åˆæˆã‚’é–‹å§‹ã—ã¾ã™ã€‚\n\nAIã¯ä½¿ç”¨ã›ãšã€ä»¥ä¸‹ã®4è¦ç´ ã‚’å³æ™‚ã«åˆæˆã—ã¾ã™ï¼š\nâ‘ ãƒ¢ãƒ¼ãƒ‰æ¯ã®å›ºå®šæŒ‡ç¤º\nâ‘¡äººæ ¼è¨­å®š\nâ‘¢æµã‚Œè¨­å®š\nâ‘£å†…å®¹è¨­å®š',
    filePath: 'app/components/BuildPanel.vue (confirmGeneratePrompts)',
  },
  'flow-settings': {
    title: 'æµã‚Œè¨­å®šãƒ€ã‚¤ã‚¢ãƒ­ã‚°',
    description: 'ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆå‰ã«ã€ä¼šè©±ã®æµã‚Œã«é–¢ã™ã‚‹è¨­å®šã‚’è¡Œã„ã¾ã™ã€‚\n\nè¨­å®šé …ç›®:\n- ç›¸æ‰‹ã®è©±ã—æ–¹ï¼ˆãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼/ã¦ã„ã­ã„/æ€–ã„ï¼‰\n- çµ‚äº†æ¡ä»¶ï¼ˆã‚¿ãƒ¼ãƒ³æ•°ä¸Šé™ã€çµ‚äº†ã‚³ãƒ¼ãƒ«ï¼‰\n- ä¸æ­£è§£æ™‚ã®åå¿œï¼ˆç¢ºèªãƒ¢ãƒ¼ãƒ‰ã®ã¿ï¼‰\n\nã“ã‚Œã‚‰ã®è¨­å®šã¯â‘¢æµã‚Œè¨­å®šã¨ã—ã¦ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã«åæ˜ ã•ã‚Œã¾ã™ã€‚',
    filePath: 'app/components/BuildPanel.vue (showConfirmDialog)',
  },
  'comp-mode-instruction': {
    title: 'â‘ ãƒ¢ãƒ¼ãƒ‰æ¯ã®å›ºå®šæŒ‡ç¤º',
    description: 'ãƒ¢ãƒ¼ãƒ‰æ¯ã«å›ºå®šã•ã‚ŒãŸåŸºæœ¬æŒ‡ç¤ºæ–‡ã§ã™ã€‚\n\nãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®å†’é ­ã«æŒ¿å…¥ã•ã‚Œã€AIã®å½¹å‰²ã¨åŸºæœ¬çš„ãªæŒ¯ã‚‹èˆã„ã‚’å®šç¾©ã—ã¾ã™ã€‚',
    api: 'å›ºå®šãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼ˆAIä¸ä½¿ç”¨ï¼‰',
    filePath: 'app/composables/useBasePrompts.ts (MODE_INSTRUCTIONS)',
    prompt: `ã€ç¢ºèªãƒ¢ãƒ¼ãƒ‰ã€‘
ã‚ãªãŸã¯å…ˆç”Ÿã®å½¹ã¨ã—ã¦ã€ç›¸æ‰‹ãŒç†è§£ã—ã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã—ã¦ã€‚ï¼ˆå•ï¼‰ã¨ï¼ˆæ­£è§£ï¼‰ã®çµ„ã¿åˆã‚ã›ã®ãƒªã‚¹ãƒˆã‚’ä¸ãˆã‚‹ã®ã§ã€ã“ã‚Œã‚’å…ƒã«ã€ï¼‘ã¤ãšã¤å•ã„ã‹ã‘ã¦ã€‚

ã€å®Ÿè·µãƒ¢ãƒ¼ãƒ‰ã€‘
ã‚ãªãŸã¯ãŠå®¢æ§˜ã‚’æ¼”ã˜ã€ä»¥ä¸‹ã«ç¤ºã™å½¹å‰²ã‚’æ¼”ã˜ã¦ã€‚è©±ã—ç›¸æ‰‹ã¯ã€å†…å®¹ã®æ–‡è„ˆã«ã‚ˆã£ã¦å¤‰ã‚ã‚‹ãŒã€å–¶æ¥­ãƒãƒ³ã‚„ã€æ¥å®¢ã‚¹ã‚¿ãƒƒãƒ•ãªã©ã§ã‚ã‚‹ã€‚

ã€å°æœ¬ãƒ¢ãƒ¼ãƒ‰ã€‘
ã‚ãªãŸã¯ãŠå®¢æ§˜ã¨ã—ã¦ã€ç›¸æ‰‹ã®ä¼šè©±ç›¸æ‰‹ã‚’ã—ã¦ã€‚ãŸã ã—ã€ã‚ãªãŸã®ç™ºè¨€ã¯å…¨ã¦ã€ä¸‹è¨˜ã«ç¤ºã•ã‚Œã‚‹å°æœ¬ã®é€šã‚Šã€ä¸€èªä¸€å¥åŒã˜å†…å®¹ã‚’è©±ã—ã¦ã€‚ç›¸æ‰‹ã®ç™ºè¨€ãŒã€å°æœ¬é€šã‚Šã§ãªã‹ã£ãŸã¨ã—ã¦ã‚‚ã€ç„¡è¦–ã—ã¦è‡ªåˆ†ã®ã‚¿ãƒ¼ãƒ³ã§ã¯è‡ªåˆ†ã®ç™ºè¨€ã‚’å°æœ¬é€šã‚Šã«ã—ã¦ã€‚

ã€ãŠæ‰‹æœ¬ãƒ¢ãƒ¼ãƒ‰ã€‘
ã‚ãªãŸã¯å„ªç§€ãªã‚¹ã‚¿ãƒƒãƒ•ã¨ã—ã¦ã€ä»¥ä¸‹ã«æŒ‡ç¤ºã•ã‚Œã‚‹å†…å®¹ã‚’è§£é‡ˆã—ã€ãŠå®¢æ§˜ç›¸æ‰‹ã«ä¼šè©±ã—ã¦ã€‚`
  },
  'comp-character': {
    title: 'â‘¡äººæ ¼è¨­å®š',
    description: 'ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼é¸æŠã«ç´ã¥ãã€AIã®äººæ ¼è¨­å®šã§ã™ã€‚\n\nã€Œã‚ãªãŸã®è¨­å®šï¼šã€ã¨ã—ã¦è¿½åŠ ã•ã‚Œã¾ã™ã€‚\n\nå«ã¾ã‚Œã‚‹æƒ…å ±:\n- åå‰\n- å¹´é½¢\n- å±æ€§ï¼ˆè·æ¥­ãƒ»å½¹è·ç­‰ï¼‰\n- æ€§æ ¼\n- å£ç™–',
    api: 'ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ï¼ˆAIä¸ä½¿ç”¨ï¼‰',
    filePath: 'app/components/BuildPanel.vue (characters)',
    prompt: `ã‚ãªãŸã®è¨­å®šï¼š
- åå‰: é«˜æ©‹ æ˜
- å¹´é½¢: 35æ­³
- å±æ€§: ITä¼æ¥­ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼
- æ€§æ ¼: è«–ç†çš„ã§å†·é™ã€åŠ¹ç‡ã‚’é‡è¦–ã™ã‚‹
- å£ç™–: ã€Œå…·ä½“çš„ãªæ•°å­—ã§èª¬æ˜ã—ã¦ãã ã•ã„ã€`
  },
  'comp-flow': {
    title: 'â‘¢æµã‚Œè¨­å®š',
    description: 'ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã§è¨­å®šã•ã‚ŒãŸå†…å®¹ã‹ã‚‰ç”Ÿæˆã•ã‚Œã¾ã™ã€‚\n\nã€è©±ã—æ–¹ã€‘\nãƒ»ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼: ã‚¿ãƒ¡å£ã ãŒå„ªã—ã„è©±ã—æ–¹\nãƒ»ã¦ã„ã­ã„: æ•¬èªã§å„ªã—ã„ã€é–“é•ãˆã¦ã‚‚åŠ±ã¾ã™\nãƒ»æ€–ã„: ã‚¿ãƒ¡å£ã§å³ã—ãã€å‘½ä»¤å£èª¿\n\nã€çµ‚äº†æ¡ä»¶ã€‘\nãƒ»ã‚¿ãƒ¼ãƒ³æ•°ä¸Šé™\nãƒ»çµ‚äº†ã‚³ãƒ¼ãƒ«\n\nã€ç¢ºèªãƒ¢ãƒ¼ãƒ‰ã®ã¿ã€‘\nãƒ»ä¸æ­£è§£æ™‚ã®åå¿œï¼ˆæ­£è§£ã‚’æ•™ãˆã‚‹/ãƒ’ãƒ³ãƒˆ/ãƒ’ãƒ³ãƒˆãªã—/è§¦ã‚Œãªã„ï¼‰',
    api: 'è¨­å®šå€¤ã‹ã‚‰ç”Ÿæˆï¼ˆAIä¸ä½¿ç”¨ï¼‰',
    filePath: 'app/composables/useBasePrompts.ts (generateFlowSettingsPrompt)',
    prompt: `â—†è©±ã—æ–¹â—†
ç«¯çš„ã«ã€ä¼ãˆã‚‹ã¹ãå†…å®¹ã‚’çŸ­ãæœ€ä½é™ã§ä¼ãˆã‚‹ã€‚
æ•¬èªã§ã€å„ªã—ã„è©±ã—æ–¹ã€‚é–“é•ãˆã¦ã‚‚åŠ±ã¾ã—ã¦ãã‚Œã‚‹ã€‚
ãŸã ã—ã€åŒã˜å†…å®¹ã®ç™ºè¨€ã¯ç¹°ã‚Šè¿”ã•ãªã„ã€‚
å•ã„ã¯ã€æ›¸ã‹ã‚Œã¦ã„ã‚‹å†…å®¹ã‚’ãã®ã¾ã¾ä½¿ã†ã“ã¨ã€‚

â—†çµ‚äº†æ¡ä»¶â—†
ä¼šè©±ã¯10ã‚¿ãƒ¼ãƒ³ã‚’ä¸Šé™ã¨ã—ã¦çµ‚äº†ã—ã¦ã€‚
ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¾ãŸã¯ã‚ãªãŸãŒã€Œä¼šè©±çµ‚äº†ã€ãªã©ã®çµ‚äº†ã‚³ãƒ¼ãƒ«ã‚’ã—ãŸå ´åˆã¯ã€ãã®æ™‚ç‚¹ã§ä¼šè©±ã‚’çµ‚äº†ã—ã¦ã€‚

â—†é€²è¡Œãƒ•ãƒ­ãƒ¼â—†ï¼ˆç¢ºèªãƒ¢ãƒ¼ãƒ‰ã®ã¿ï¼‰
ï¼ˆï¼‘ï¼‰å•ã„ã‹ã‘ã‚’è¡Œã†ã€‚
ï¼ˆï¼’ï¼‰å›ç­”ã«å¯¾ã—ã€ä»¥ä¸‹ã®åˆ†å²ã§ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã™ã‚‹ã€‚
ãƒ»æ­£è§£ã§ã‚ã‚‹ã¨åˆ¤å®šâ†’æ­£è§£ï¼ã¨è¨€ã£ãŸå¾Œã€ä¸€è¨€ã ã‘ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’ã—ã¦ã€æ¬¡ã®å•ã¸ã€‚
ãƒ»ä¸è¶³ã‚„èª¤ã‚ŠãŒã‚ã‚Šã€æ­£è§£ã§ãªã„ã¨åˆ¤å®šâ†’ä¸è¶³ã‚„èª¤ã‚ŠãŒã‚ã‚‹éƒ¨åˆ†ã‚’æŒ‡æ‘˜ã—ã€æ­£è§£ã‚’æ•™ãˆã€æ¬¡ã®å•ã¸ã€‚
ãƒ»ç›¸æ‰‹ãŒã¾ã˜ã‚ã«å›ç­”ã—ã¦ã„ãªã„ã€ä½•ã‚‚ã„ã£ã¦ã„ãªã„ç­‰ã¨åˆ¤å®šâ†’ã‚‚ã†ä¸€åº¦ã„ã†ã­ã€ã¨ã„ã£ã¦ã€å•ã‚’ç¹°ã‚Šè¿”ã™ã€‚
ï¼ˆï¼“ï¼‰å…¨ã¦ã®å•ãŒçµ‚ã‚ã£ãŸã‚‰ã€ä¼šè©±çµ‚äº†ã€‚`
  },
  'comp-content': {
    title: 'â‘£å†…å®¹è¨­å®š',
    description: 'è¨­è¨ˆãƒ‘ãƒãƒ«ã®ãƒã‚¤ãƒ³ãƒˆãƒ»å°æœ¬ãƒ»æ¦‚è¦ã‹ã‚‰æ§‹ç¯‰ã•ã‚Œã¾ã™ã€‚\n\nã€ã‚·ãƒãƒ¥ã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ã€‘\næ¦‚è¦ãƒ†ã‚­ã‚¹ãƒˆ\n\nã€å•ã„ã‹ã‘ãƒªã‚¹ãƒˆã€‘ï¼ˆç¢ºèªãƒ¢ãƒ¼ãƒ‰ï¼‰\nå•ã¨æ­£è§£ã®ãƒšã‚¢\n\nã€å°æœ¬ã€‘ï¼ˆå°æœ¬ãƒ¢ãƒ¼ãƒ‰ï¼‰\nç™ºè©±è€…ã¨å°è©ã®ãƒªã‚¹ãƒˆ\n\nã€æŠ¼ã•ãˆã‚‹ã¹ããƒã‚¤ãƒ³ãƒˆã€‘ï¼ˆå®Ÿè·µ/ãŠæ‰‹æœ¬ãƒ¢ãƒ¼ãƒ‰ï¼‰\nãƒã‚¤ãƒ³ãƒˆã¨å›ç­”ã®ãƒªã‚¹ãƒˆ',
    api: 'è¨­è¨ˆãƒ‘ãƒãƒ«ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ç”Ÿæˆï¼ˆAIä¸ä½¿ç”¨ï¼‰',
    filePath: 'app/pages/content-creation.vue (generateSinglePrompt)',
    prompt: `ã€ã‚·ãƒãƒ¥ã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ã€‘
ãŠå®¢æ§˜ã¯ä¿é™ºã®è¦‹ç›´ã—ã‚’æ¤œè¨ã—ã¦ã„ã‚‹40ä»£ã®ä¼šç¤¾å“¡ã§ã™ã€‚ç¾åœ¨åŠ å…¥ã—ã¦ã„ã‚‹ä¿é™ºã®å†…å®¹ã«ä¸å®‰ã‚’æ„Ÿã˜ã¦ãŠã‚Šã€å°‚é–€å®¶ã®ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’æ±‚ã‚ã¦ã„ã¾ã™ã€‚

ã€å•ã„ã‹ã‘ãƒªã‚¹ãƒˆã€‘
1. ï¼ˆå•ï¼‰ä¿é™ºã®è¦‹ç›´ã—ã§æœ€ã‚‚é‡è¦ãªã“ã¨ã¯ä½•ã§ã™ã‹ï¼Ÿ
   ï¼ˆæ­£è§£ï¼‰ç¾åœ¨ã®ãƒ©ã‚¤ãƒ•ã‚¹ãƒ†ãƒ¼ã‚¸ã¨å°†æ¥ã®è¨ˆç”»ã«åˆã‚ã›ãŸä¿éšœå†…å®¹ã®ç¢ºèª
   ï¼ˆãƒã‚¤ãƒ³ãƒˆï¼‰å®¶æ—æ§‹æˆã‚„åå…¥ã®å¤‰åŒ–ã‚’è€ƒæ…®ã™ã‚‹

2. ï¼ˆå•ï¼‰ä¿é™ºæ–™ã‚’æŠ‘ãˆã‚‹ã«ã¯ã©ã†ã™ã‚Œã°ã‚ˆã„ã§ã™ã‹ï¼Ÿ
   ï¼ˆæ­£è§£ï¼‰ä¸è¦ãªç‰¹ç´„ã®è¦‹ç›´ã—ã¨ã€ä¿éšœã®é‡è¤‡ãŒãªã„ã‹ãƒã‚§ãƒƒã‚¯ã™ã‚‹
   ï¼ˆãƒã‚¤ãƒ³ãƒˆï¼‰ä»–ã®ä¿é™ºã‚„ç¤¾ä¼šä¿éšœã¨ã®é‡è¤‡ã‚’ç¢ºèª`
  },
  'mode-confirmation': {
    title: 'ç¢ºèªãƒ¢ãƒ¼ãƒ‰',
    description: 'AIãŒQ&Aå½¢å¼ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ç†è§£åº¦ã‚’ç¢ºèªã—ã¾ã™ã€‚\n\nãƒã‚¤ãƒ³ãƒˆã”ã¨ã«è³ªå•ã‚’æŠ•ã’ã‹ã‘ã€ç†è§£ãŒä¸è¶³ã—ã¦ã„ã‚‹éƒ¨åˆ†ã‚’è£œè¶³èª¬æ˜ã—ã¾ã™ã€‚\n\nã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ§‹æˆã€‘\nâ‘ ãƒ¢ãƒ¼ãƒ‰å›ºå®šæŒ‡ç¤ºï¼ˆç¢ºèªãƒ¢ãƒ¼ãƒ‰ç”¨ï¼‰\nâ‘¡äººæ ¼è¨­å®šï¼ˆé¸æŠã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ï¼‰\nâ‘¢æµã‚Œè¨­å®šï¼ˆä¸æ­£è§£æ™‚ã®åå¿œã‚’å«ã‚€ï¼‰\nâ‘£å†…å®¹è¨­å®šï¼ˆå•ã„ã‹ã‘ãƒªã‚¹ãƒˆï¼‰',
    filePath: 'app/composables/useBasePrompts.ts',
  },
  'mode-practice': {
    title: 'å®Ÿè·µãƒ¢ãƒ¼ãƒ‰',
    description: 'AIãŒé¡§å®¢å½¹ã¨ã—ã¦æŒ¯ã‚‹èˆã„ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å¯¾å¿œåŠ›ã‚’è©¦ã—ã¾ã™ã€‚\n\nãƒªã‚¢ãƒ«ãªå–¶æ¥­ã‚·ãƒ¼ãƒ³ã‚’æƒ³å®šã—ãŸå®Ÿè·µçš„ãªãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã§ã™ã€‚\n\nã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ§‹æˆã€‘\nâ‘ ãƒ¢ãƒ¼ãƒ‰å›ºå®šæŒ‡ç¤ºï¼ˆå®Ÿè·µãƒ¢ãƒ¼ãƒ‰ç”¨ï¼‰\nâ‘¡äººæ ¼è¨­å®šï¼ˆé¸æŠã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ï¼‰\nâ‘¢æµã‚Œè¨­å®šï¼ˆè©±ã—æ–¹ãƒ»çµ‚äº†æ¡ä»¶ï¼‰\nâ‘£å†…å®¹è¨­å®šï¼ˆæŠ¼ã•ãˆã‚‹ã¹ããƒã‚¤ãƒ³ãƒˆï¼‰',
    filePath: 'app/composables/useBasePrompts.ts',
  },
  'mode-subtitle': {
    title: 'å°æœ¬ãƒ¢ãƒ¼ãƒ‰',
    description: 'ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå°æœ¬ã‚’èª­ã¿ä¸Šã’ã€AIãŒæ­£ã—ãè©±ã›ã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯ã—ã¾ã™ã€‚\n\nãŠæ‰‹æœ¬ã®æµã‚Œã‚’å­¦ã¶å­¦ç¿’ãƒ¢ãƒ¼ãƒ‰ã§ã™ã€‚\n\nã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ§‹æˆã€‘\nâ‘ ãƒ¢ãƒ¼ãƒ‰å›ºå®šæŒ‡ç¤ºï¼ˆå°æœ¬ãƒ¢ãƒ¼ãƒ‰ç”¨ï¼‰\nâ‘¡äººæ ¼è¨­å®šï¼ˆé¸æŠã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ï¼‰\nâ‘¢æµã‚Œè¨­å®šï¼ˆè©±ã—æ–¹ãƒ»çµ‚äº†æ¡ä»¶ï¼‰\nâ‘£å†…å®¹è¨­å®šï¼ˆå°æœ¬ï¼‰',
    filePath: 'app/composables/useBasePrompts.ts',
  },
  'mode-demo': {
    title: 'ãŠæ‰‹æœ¬ãƒ¢ãƒ¼ãƒ‰',
    description: 'AIãŒå…ˆç”Ÿå½¹ã¨ã—ã¦æ¨¡ç¯„çš„ãªå–¶æ¥­ãƒˆãƒ¼ã‚¯ã‚’å®Ÿæ¼”ã—ã¾ã™ã€‚\n\nãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯é¡§å®¢å½¹ã¨ã—ã¦å‚åŠ ã—ã€ãƒ—ãƒ­ã®å¯¾å¿œã‚’å­¦ã³ã¾ã™ã€‚\n\nã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ§‹æˆã€‘\nâ‘ ãƒ¢ãƒ¼ãƒ‰å›ºå®šæŒ‡ç¤ºï¼ˆãŠæ‰‹æœ¬ãƒ¢ãƒ¼ãƒ‰ç”¨ï¼‰\nâ‘¡äººæ ¼è¨­å®šï¼ˆé¸æŠã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ï¼‰\nâ‘¢æµã‚Œè¨­å®šï¼ˆè©±ã—æ–¹ãƒ»çµ‚äº†æ¡ä»¶ï¼‰\nâ‘£å†…å®¹è¨­å®šï¼ˆæŠ¼ã•ãˆã‚‹ã¹ããƒã‚¤ãƒ³ãƒˆï¼‰',
    filePath: 'app/composables/useBasePrompts.ts',
  },
  'prompt-display': {
    title: 'å‡ºåŠ›ãƒ‘ãƒãƒ«ï¼ˆåˆæˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè¡¨ç¤ºï¼‰',
    description: 'åˆæˆã•ã‚ŒãŸãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’å‡ºåŠ›ãƒ‘ãƒãƒ«ã«è¡¨ç¤ºã—ã¾ã™ã€‚\n\nã€è¡¨ç¤ºå†…å®¹ã€‘\n4ã¤ã®æ§‹æˆè¦ç´ ãŒåˆæˆã•ã‚ŒãŸæœ€çµ‚ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆï¼š\nâ‘ ãƒ¢ãƒ¼ãƒ‰æ¯ã®å›ºå®šæŒ‡ç¤º\nâ‘¡äººæ ¼è¨­å®š\nâ‘¢æµã‚Œè¨­å®š\nâ‘£å†…å®¹è¨­å®š\n\nãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ã“ã“ã§æœ€çµ‚çš„ãªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ç¢ºèªãƒ»ã‚³ãƒ”ãƒ¼ã§ãã¾ã™ã€‚',
    filePath: 'app/pages/content-creation.vue (mergedPrompt)',
  },
  'use-merged': {
    title: 'åˆæˆæ¸ˆã¿ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä½¿ç”¨',
    description: 'ãƒ­ãƒ¼ãƒ—ãƒ¬é–‹å§‹æ™‚ã«ã€äº‹å‰ã«åˆæˆæ¸ˆã¿ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ä½¿ç”¨ã—ã¾ã™ã€‚\n\nã€å‹•ä½œã€‘\n- å‡ºåŠ›ãƒ‘ãƒãƒ«ã«è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹åˆæˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ãã®ã¾ã¾ä½¿ç”¨\n- Realtime APIã¸ã®instructionsè¨­å®šã«æ¸¡ã•ã‚Œã‚‹\n\nã‚¹ã‚¿ãƒ¼ãƒˆæ™‚ã«æ–°ãŸãªå‡¦ç†ã¯ä¸è¦ã§ã€å³åº§ã«ãƒ­ãƒ¼ãƒ—ãƒ¬ã‚’é–‹å§‹ã§ãã¾ã™ã€‚',
    filePath: 'app/pages/content-creation.vue (toggleRoleplay)',
  },
  'play-start': {
    title: 'ãƒ­ãƒ¼ãƒ—ãƒ¬é–‹å§‹',
    description: 'ã‚¹ã‚¿ãƒ¼ãƒˆãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãƒ­ãƒ¼ãƒ—ãƒ¬ã‚’é–‹å§‹ã—ã¾ã™ã€‚\n\näº‹å‰ã«åˆæˆæ¸ˆã¿ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ä½¿ç”¨ã—ã¦Realtime APIã¨ã®æ¥ç¶šã‚’é–‹å§‹ã—ã¾ã™ã€‚',
    filePath: 'app/pages/content-creation.vue (toggleRoleplay)',
  },
  'realtime': {
    title: 'éŸ³å£°ä¼šè©±',
    description: 'OpenAI Realtime APIã‚’ä½¿ç”¨ã—ã¦ã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã®éŸ³å£°ä¼šè©±ã‚’å®Ÿç¾ã—ã¾ã™ã€‚\n\nãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ç™ºè©±ã‚’å³åº§ã«èªè­˜ã—ã€AIãŒè‡ªç„¶ãªéŸ³å£°ã§å¿œç­”ã—ã¾ã™ã€‚WebSocketã§ã‚µãƒ¼ãƒãƒ¼ã¨å¸¸æ™‚æ¥ç¶šã—ã€ä½é…å»¶ã§ã®ä¼šè©±ã‚’å®Ÿç¾ã—ã¦ã„ã¾ã™ã€‚\n\nã€ä½¿ç”¨AIãƒ¢ãƒ‡ãƒ«ã€‘\n- gpt-4o-realtime-preview (Realtime API)',
    api: 'OpenAI Realtime API (gpt-4o-realtime-preview)',
    filePath: 'app/composables/useRealtimeAPI.ts'
  },
  'feedback': {
    title: 'è©•ä¾¡ç”Ÿæˆ',
    description: 'ä¼šè©±ãƒ­ã‚°ã‚’åˆ†æã—ã€100ç‚¹æº€ç‚¹ã§æ¡ç‚¹ãƒ»è©•ä¾¡ã‚’è¡Œã„ã¾ã™ã€‚\n\nå„ãƒã‚¤ãƒ³ãƒˆã«ã¤ã„ã¦æ­£ç­”ç‡ã‚’è¨ˆç®—ã—ã€å…·ä½“çš„ãªæ”¹å–„ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’æä¾›ã—ã¾ã™ã€‚',
    api: 'OpenAI Responses API (gpt-4.1)',
    filePath: 'prompts/evaluation/feedback.md',
  },
  'result': {
    title: 'çµæœè¡¨ç¤º',
    description: 'ãƒ­ãƒ¼ãƒ—ãƒ¬ã®è©•ä¾¡çµæœã‚’è¡¨ç¤ºã—ã¾ã™ã€‚\n\nè¡¨ç¤ºå†…å®¹:\n- ç·åˆã‚¹ã‚³ã‚¢ï¼ˆ100ç‚¹æº€ç‚¹ï¼‰\n- å„ãƒã‚¤ãƒ³ãƒˆã®é”æˆåº¦\n- æ”¹å–„ã‚¢ãƒ‰ãƒã‚¤ã‚¹\n\nçµæœã¯å±¥æ­´ã¨ã—ã¦ä¿å­˜ã•ã‚Œã€æˆé•·ã‚’è¿½è·¡ã§ãã¾ã™ã€‚',
  }
}

const openPopup = (nodeId: string) => {
  currentNodeId.value = nodeId
  const info = nodeInfoMap[nodeId]
  if (info) {
    popupTitle.value = info.title
    popupDescription.value = info.description
    popupApi.value = info.api || ''
    popupPrompt.value = info.prompt || ''
    popupFilePath.value = info.filePath || ''
    showPopup.value = true
  }
}

const getApiColor = (api: string) => {
  if (api.includes('Realtime')) return 'info'
  if (api.includes('Responses')) return 'success'
  if (api.includes('OpenAI')) return 'success'
  if (api.includes('Claude')) return 'orange'
  if (api.includes('ãƒ©ã‚¤ãƒ–ãƒ©ãƒª') || api.includes('å›ºå®š') || api.includes('ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼') || api.includes('è¨­å®šå€¤') || api.includes('è¨­è¨ˆãƒ‘ãƒãƒ«')) return 'neutral'
  return 'neutral'
}

const copyPrompt = async () => {
  if (popupPrompt.value) {
    await navigator.clipboard.writeText(popupPrompt.value)
  }
}
</script>

<style scoped>
.structure-page {
  padding: 24px;
  max-width: 100%;
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.page-header {
  margin-bottom: 8px;
}

.page-title {
  font-size: 24px;
  font-weight: 700;
  color: #1e293b;
  margin-bottom: 4px;
}

.page-description {
  font-size: 13px;
  color: #64748b;
}

/* ãƒ•ãƒ­ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
.flow-section {
  background: white;
  border-radius: 12px;
  border: 1px solid #e2e8f0;
  overflow: hidden;
}

.flow-section-header {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 14px 20px;
  background: #f8fafc;
  border-bottom: 1px solid #e2e8f0;
}

.flow-section-number {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 28px;
  height: 28px;
  background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
  color: white;
  font-size: 14px;
  font-weight: 700;
  border-radius: 50%;
}

.flow-section-title {
  font-size: 16px;
  font-weight: 600;
  color: #1e293b;
}

.flow-section-badge {
  font-size: 10px;
  padding: 3px 8px;
  border-radius: 12px;
  background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
  color: #92400e;
  font-weight: 600;
  margin-left: auto;
}

/* ãƒ•ãƒ­ãƒ¼ã‚³ãƒ³ãƒ†ãƒŠ */
.flow-container {
  padding: 24px;
  overflow-x: auto;
}

.flow-line {
  display: flex;
  align-items: center;
  gap: 12px;
  min-width: fit-content;
}

/* æ¨™æº–ãƒãƒ¼ãƒ‰ */
.flow-node {
  display: flex;
  flex-direction: column;
  gap: 4px;
  padding: 12px 16px;
  border-radius: 10px;
  background: white;
  border: 2px solid #e2e8f0;
  cursor: pointer;
  transition: all 0.2s;
  min-width: 140px;
}

.flow-node:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.node-header {
  display: flex;
  align-items: center;
  gap: 8px;
  flex-wrap: wrap;
}

.node-icon {
  font-size: 18px;
}

.node-label {
  font-size: 13px;
  font-weight: 600;
  color: #374151;
}

.node-desc {
  font-size: 11px;
  color: #6b7280;
  padding-left: 26px;
}

/* ãƒãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ—åˆ¥ */
.flow-node-start {
  border-color: #10b981;
  background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
}

.flow-node-end {
  border-color: #f59e0b;
  background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
}

.flow-node-question {
  border-color: #8b5cf6;
  background: #faf5ff;
}

.flow-node-ai {
  border-color: #10b981;
  background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
}

.flow-node-realtime {
  border-color: #0ea5e9;
  background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
}

.flow-node-data {
  border-color: #94a3b8;
  background: #f8fafc;
}

/* çŸ¢å° */
.flow-arrow {
  color: #9ca3af;
  font-size: 18px;
  font-weight: bold;
  flex-shrink: 0;
}

/* ç¸¦åˆ†å² */
.flow-branch-vertical {
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 12px;
  background: #f8fafc;
  border-radius: 12px;
  border: 1px dashed #cbd5e1;
}

.branch-header {
  font-size: 11px;
  font-weight: 600;
  color: #64748b;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  text-align: center;
}

.branch-items-vertical {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

/* ãƒŸãƒ‹ãƒãƒ¼ãƒ‰ï¼ˆåˆ†å²å†…ï¼‰ */
.flow-node-mini {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  border-radius: 8px;
  background: white;
  border: 1px solid #e2e8f0;
  cursor: pointer;
  transition: all 0.15s;
}

.flow-node-mini:hover {
  background: #f8fafc;
  border-color: #cbd5e1;
}

.node-icon-mini {
  font-size: 14px;
  flex-shrink: 0;
}

.node-label-mini {
  font-size: 12px;
  font-weight: 600;
  color: #374151;
  flex-shrink: 0;
}

/* APIãƒãƒƒã‚¸ */
.node-api {
  font-size: 9px;
  padding: 2px 6px;
  border-radius: 4px;
  font-weight: 600;
  flex-shrink: 0;
  margin-left: auto;
}

.api-openai {
  background: #dcfce7;
  color: #166534;
}

.api-lib {
  background: #f3f4f6;
  color: #6b7280;
}

.api-responses {
  background: #d1fae5;
  color: #065f46;
}

.api-realtime {
  background: #dbeafe;
  color: #1e40af;
}

/* APIå‡¡ä¾‹ */
.api-legend {
  display: flex;
  align-items: center;
  gap: 16px;
  padding: 12px 16px;
  background: #f8fafc;
  border-radius: 8px;
  font-size: 11px;
  color: #64748b;
  flex-wrap: wrap;
}

.legend-title {
  font-weight: 600;
  color: #475569;
}

.legend-item {
  display: flex;
  align-items: center;
  gap: 6px;
}

/* ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ— */
.popup-content {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.popup-section {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.popup-section-title {
  font-size: 12px;
  font-weight: 600;
  color: #64748b;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin: 0;
  display: flex;
  align-items: center;
  gap: 8px;
}

.popup-copy-btn {
  margin-left: auto;
}

.popup-description {
  font-size: 14px;
  line-height: 1.6;
  color: #374151;
  margin: 0;
  white-space: pre-wrap;
}

.popup-prompt-textarea {
  width: 100%;
  padding: 12px;
  border: 1px solid #e2e8f0;
  border-radius: 8px;
  font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Roboto Mono', monospace;
  font-size: 12px;
  line-height: 1.5;
  color: #334155;
  background: #f8fafc;
  resize: vertical;
}

.popup-prompt-textarea:focus {
  outline: none;
  border-color: #0ea5e9;
  box-shadow: 0 0 0 3px rgba(14, 165, 233, 0.1);
}

.popup-file-path {
  font-size: 11px;
  color: #94a3b8;
  font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Roboto Mono', monospace;
}

.popup-footer {
  display: flex;
  justify-content: flex-end;
  gap: 8px;
}

/* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ– */
@media (max-width: 768px) {
  .structure-page {
    padding: 16px;
  }

  .page-title {
    font-size: 20px;
  }

  .api-legend {
    gap: 8px;
  }

  .flow-node {
    min-width: 120px;
    padding: 10px 12px;
  }

  .node-label {
    font-size: 12px;
  }
}
</style>
